---
import BaseLayout from "../layouts/BaseLayout.astro";
import Button from "../components/Button.astro";
import { Image, getImage } from "astro:assets";
import HeroImage from "../components/HeroImage.astro";
import WeddingGallery from "../components/WeddingGallery.svelte";

// Import images
import heroImage from "../assets/images/wedding-dance-dip-kiss.webp";

// Import gallery images
const galleryImages = import.meta.glob<{ default: ImageMetadata }>(
  "../assets/images/wedding-gallery/*.webp",
  { eager: true }
);

// Convert to array and sort
const galleryArray = Object.entries(galleryImages)
  .map(([_path, module]) => ({
    src: module.default,
    alt: "Wedding at Valiant Vineyards",
  }))
  .sort((a, b) => {
    // Extract number from filename for sorting
    const numA = parseInt(a.src.src.match(/wedding-(\d+)/)?.[1] ?? "0");
    const numB = parseInt(b.src.src.match(/wedding-(\d+)/)?.[1] ?? "0");
    return numA - numB;
  });

// Generate optimized image URLs for the lightbox with dimensions
const lightboxImages = await Promise.all(
  galleryArray.map(async (image) => {
    const optimized = await getImage({ src: image.src, width: 1200, quality: 75 });
    // Calculate height based on original aspect ratio
    const aspectRatio = image.src.height / image.src.width;
    const height = Math.round(1200 * aspectRatio);
    return { src: optimized.src, alt: image.alt, width: 1200, height };
  })
);

const venueFeatures = [
  {
    title: "Breathtaking Views",
    description: "With sweeping views of the countryside and open skies, our grounds offer stunning natural backdrops for your ceremony and photos.",
    icon: "mountain",
  },
  {
    title: "Elegant Banquet Hall",
    description: "Our spacious hall features a stone fireplace, beautiful murals, and accommodates up to 200 guests for your reception.",
    icon: "building",
  },
  {
    title: "Wine Barrel Cellar",
    description: "A unique photo opportunity among oak barrels - perfect for wedding party portraits with vineyard character.",
    icon: "barrel",
  },
  {
    title: "Award-Winning Wines",
    description: "Toast your new life together with wines crafted right here at the vineyard, plus handcrafted spirits from our distillery.",
    icon: "wine",
  },
];

const includedServices = [
  "Flexible ceremony locations",
  "Indoor & outdoor options",
  "Full catering services",
  "Wine & spirits bar",
  "Custom table arrangements",
  "Dance floor space",
  "Setup & cleanup",
];
---

<BaseLayout title="Weddings" description="Celebrate your wedding at Valiant Vineyards - a stunning vineyard venue in South Dakota wine country for your special day.">
  <!-- Hero Section -->
  <section class="relative">
    <div class="relative min-h-[70vh] xl:min-h-[80vh] flex items-center justify-center py-24 bg-neutral-900">
      <HeroImage
        src={heroImage}
        alt="Couple sharing a romantic dip kiss during their first dance at Valiant Vineyards"
        widths={[640, 1024, 1536, 2048]}
        sizes="100vw"
        quality={70}
        position="70% center"
      />
      <div class="container relative mx-auto px-4 lg:px-8 text-center">
        <div class="inline-block bg-black/50 px-8 py-6">
          <h1 class="font-serif text-4xl font-semibold tracking-tight text-white sm:text-5xl lg:text-6xl">
            Your Perfect Day Starts Here
          </h1>
          <p class="mt-4 font-serif text-xl text-white font-medium max-w-2xl mx-auto lg:text-2xl">
            Where golden sunsets, stunning views, and heartfelt moments create the wedding of your dreams
          </p>
          <div class="mt-8">
            <Button
              href="/contact"
              variant="gold"
              size="lg"
            >
              Start Planning Your Day
            </Button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Introduction -->
  <section class="py-16 lg:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="mx-auto max-w-3xl text-center">
        <h2 class="font-serif text-3xl font-semibold tracking-tight sm:text-4xl mb-6">
          Your Love Story Deserves a Beautiful Setting
        </h2>
        <p class="text-lg leading-relaxed text-muted-foreground mb-4">
          Surrounded by wide-open skies and the gentle countryside near Vermillion, Valiant Vineyards offers a picturesque escape for couples seeking a venue as unique as their love. Our family-owned vineyard combines rustic elegance with warm hospitality to create an unforgettable wedding experience.
        </p>
        <p class="text-lg leading-relaxed text-muted-foreground">
          From intimate elopements to grand celebrations of up to 200 guests, we work closely with each couple to bring their vision to life. Exchange vows beneath open skies, dance the night away in our elegant banquet hall, and toast to forever with award-winning wines crafted right here on our estate.
        </p>
      </div>
    </div>
  </section>

  <!-- Venue Features -->
  <section class="bg-neutral-50 py-16 lg:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="font-serif text-3xl font-semibold tracking-tight sm:text-4xl mb-4">
          A Venue Like No Other
        </h2>
        <p class="text-lg text-foreground max-w-2xl mx-auto">
          Every corner of our vineyard tells a story, and we can't wait to help write yours.
        </p>
      </div>

      <div class="grid gap-8 md:grid-cols-2 max-w-5xl mx-auto">
        {venueFeatures.map((feature) => (
          <div class="flex gap-4 p-6 border border-border bg-background">
            <div class="shrink-0 text-gold">
              {feature.icon === "mountain" && (
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="currentColor" viewBox="0 0 576 512">
                  <path d="M288 80C222.8 80 169.2 109.6 128.1 147.7 89.6 183.5 63 226 49.4 256 63 286 89.6 328.5 128.1 364.3 169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256 513 226 486.4 183.5 447.9 147.7 406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1 3.3 7.9 3.3 16.7 0 24.6-14.9 35.7-46.2 87.7-93 131.1-47.1 43.7-111.8 80.6-192.6 80.6S142.5 443.2 95.4 399.4c-46.8-43.5-78.1-95.4-93-131.1-3.3-7.9-3.3-16.7 0-24.6 14.9-35.7 46.2-87.7 93-131.1zM288 336c44.2 0 80-35.8 80-80 0-29.6-16.1-55.5-40-69.3-1.4 59.7-49.6 107.9-109.3 109.3 13.8 23.9 39.7 40 69.3 40zm-79.6-88.4c2.5 .3 5 .4 7.6 .4 35.3 0 64-28.7 64-64 0-2.6-.2-5.1-.4-7.6-37.4 3.9-67.2 33.7-71.1 71.1zm45.6-115c10.8-3 22.2-4.5 33.9-4.5 8.8 0 17.5 .9 25.8 2.6 .3 .1 .5 .1 .8 .2 57.9 12.2 101.4 63.7 101.4 125.2 0 70.7-57.3 128-128 128-61.6 0-113-43.5-125.2-101.4-1.8-8.6-2.8-17.5-2.8-26.6 0-11 1.4-21.8 4-32 .2-.7 .3-1.3 .5-1.9 11.9-43.4 46.1-77.6 89.5-89.5z"/>
                </svg>
              )}
              {feature.icon === "building" && (
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z" />
                </svg>
              )}
              {feature.icon === "barrel" && (
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="currentColor" viewBox="0 -64 320 640">
                  <path d="M256-64l-192 0 0 48 16 0 0 141.4C32.2 153.1 0 204.7 0 264l0 312 320 0 0-312c0-59.3-32.2-110.9-80-138.6l0-141.4 16 0 0-48zM128 48l0-64 64 0 0 64-64 0zm0 48l64 0 0 59.5 14.1 6.4C245 179.5 272 218.6 272 264l0 8-224 0 0-8c0-45.4 27-84.5 65.9-102.1l14.1-6.4 0-59.5zM272 320l0 96-224 0 0-96 224 0zm0 144l0 64-224 0 0-64 224 0z"/>
                </svg>
              )}
              {feature.icon === "wine" && (
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="currentColor" viewBox="0 0 320 544">
                  <path d="M45 0l229.9 0 4.4 18.4 36.3 152.5c2.9 12.1 4.4 24.6 4.4 37.1 0 80.2-59 146.7-136 158.2l0 129.8 88 0 0 48-224 0 0-48 88 0 0-129.8C59 354.6 0 288.2 0 208 0 195.5 1.5 183 4.4 170.9L40.7 18.4 45 0zm7.4 176L51 182c-2 8.5-3 17.2-3 26 0 61.9 50.2 112 112 112s112-50.2 112-112c0-8.7-1-17.5-3-26l-1.4-6-215 0zm11.4-48l192.2 0-19-80-154.1 0-19 80z"/>
                </svg>
              )}
            </div>
            <div>
              <h3 class="font-serif text-xl font-semibold mb-2">{feature.title}</h3>
              <p class="text-muted-foreground">{feature.description}</p>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- What's Included -->
  <section class="py-16 lg:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="max-w-6xl mx-auto">
        <div class="grid gap-12 lg:gap-16 items-center lg:grid-cols-2">
          <div>
            <h2 class="font-serif text-3xl font-semibold tracking-tight sm:text-4xl mb-6">
              Everything You Need for Your Perfect Day
            </h2>
            <p class="text-lg text-muted-foreground mb-8">
              Our experienced team handles the details so you can focus on what matters most - celebrating your love with the people who mean the most to you.
            </p>

            <ul class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              {includedServices.map((service) => (
                <li class="flex items-center gap-3 text-muted-foreground">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gold shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                  </svg>
                  <span>{service}</span>
                </li>
              ))}
            </ul>

            <div class="mt-8">
              <Button
                href="/banquet-menu-2025-r1.pdf"
                variant="gold-outline"
                size="lg"
                class="inline-flex items-center gap-2"
              >
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                View Catering Menu
              </Button>
            </div>
          </div>

          <div class="relative">
            <div class="grid grid-cols-2 gap-4">
              {galleryArray.slice(0, 4).map((image, index) => (
                <div class={`overflow-hidden shadow-lg ${index === 0 ? 'col-span-2' : ''}`}>
                  <Image
                    src={image.src}
                    alt={image.alt}
                    class={`w-full object-cover ${index === 0 ? 'h-64' : 'h-40'}`}
                    widths={[400, 800]}
                    sizes="(max-width: 1024px) 50vw, 25vw"
                    quality={75}
                  />
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Gallery Section -->
  <section class="bg-muted py-16 lg:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="font-serif text-3xl font-semibold tracking-tight sm:text-4xl mb-4">
          Real Weddings at Valiant Vineyards
        </h2>
        <p class="text-lg text-muted-foreground max-w-2xl mx-auto">
          Every wedding we host is as unique as the couple celebrating. Here are some of our favorite moments.
        </p>
      </div>

      <WeddingGallery images={lightboxImages} client:load />
    </div>
  </section>

  <!-- Booking Now Open -->
  <section class="py-16 lg:py-24 bg-linear-to-br from-gold/10 to-gold/5">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="max-w-4xl mx-auto text-center">
        <div class="inline-flex items-center gap-2 bg-gold/20 text-gold-dark px-4 py-2 rounded-full text-sm font-medium mb-6">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          Now Booking
        </div>

        <h2 class="font-serif text-3xl font-semibold tracking-tight sm:text-4xl mb-4">
          Your Date is Waiting
        </h2>
        <p class="text-lg text-muted-foreground mb-8 max-w-2xl mx-auto">
          Wedding dates at Valiant Vineyards book quickly, especially during our beautiful autumn season. Contact us today to schedule a tour and check availability for your special day.
        </p>

        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <Button
            href="tel:6056244500"
            variant="gold"
            size="lg"
            class="inline-flex items-center gap-2"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
            (605) 624-4500
          </Button>
          <Button
            href="/contact"
            variant="gold-outline"
            size="lg"
          >
            Schedule a Tour
          </Button>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="py-16 lg:py-24">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="max-w-3xl mx-auto">
        <h2 class="font-serif text-3xl font-semibold tracking-tight text-center sm:text-4xl mb-12">
          Frequently Asked Questions
        </h2>

        <div class="space-y-6">
          <details class="group border border-border bg-background p-6">
            <summary class="flex cursor-pointer items-center justify-between font-serif text-lg font-semibold">
              How many guests can you accommodate?
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-muted-foreground transition-transform group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </summary>
            <p class="mt-4 text-muted-foreground">
              Our banquet hall comfortably accommodates up to 200 guests for a seated dinner and reception. For more intimate gatherings, we can create a cozy setup for smaller groups. We're happy to discuss your specific needs during a consultation.
            </p>
          </details>

          <details class="group border border-border bg-background p-6">
            <summary class="flex cursor-pointer items-center justify-between font-serif text-lg font-semibold">
              Can we hold the ceremony on-site?
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-muted-foreground transition-transform group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </summary>
            <p class="mt-4 text-muted-foreground">
              Absolutely! We offer multiple ceremony locations including our outdoor vineyard areas with valley views and indoor options in our banquet hall. Weather backup plans are always available for outdoor ceremonies.
            </p>
          </details>

          <details class="group border border-border bg-background p-6">
            <summary class="flex cursor-pointer items-center justify-between font-serif text-lg font-semibold">
              Do you provide catering?
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-muted-foreground transition-transform group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </summary>
            <p class="mt-4 text-muted-foreground">
              Yes! Our culinary team offers a full banquet menu with options ranging from elegant plated dinners to casual buffet-style service. We can customize menus to fit your preferences and dietary requirements. Download our banquet menu for details.
            </p>
          </details>

          <details class="group border border-border bg-background p-6">
            <summary class="flex cursor-pointer items-center justify-between font-serif text-lg font-semibold">
              What about bar service?
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-muted-foreground transition-transform group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </summary>
            <p class="mt-4 text-muted-foreground">
              We offer full bar service featuring our award-winning wines and handcrafted spirits from our on-site distillery. From champagne toasts to signature cocktails, we'll help you create the perfect drink menu for your celebration.
            </p>
          </details>

          <details class="group border border-border bg-background p-6">
            <summary class="flex cursor-pointer items-center justify-between font-serif text-lg font-semibold">
              Is there lodging available nearby?
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-muted-foreground transition-transform group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </summary>
            <p class="mt-4 text-muted-foreground">
              Yes! We have a charming Bed & Breakfast right here on the vineyard property - perfect for the wedding couple or out-of-town guests. Vermillion also offers several hotels within a short drive of the venue.
            </p>
          </details>
        </div>
      </div>
    </div>
  </section>

  <!-- Back to Private Events -->
  <section class="bg-neutral-50 py-12">
    <div class="container mx-auto px-4 lg:px-8 text-center">
      <p class="text-foreground mb-4">Planning a different type of event?</p>
      <Button
        href="/private-events/"
        variant="gold-outline"
      >
        View All Private Event Options
      </Button>
    </div>
  </section>
</BaseLayout>
